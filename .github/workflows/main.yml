on:
  push:
    branches:
      - rahmat
name: ðŸš€ Deploy website on push
jobs:
  web-deploy:
    name: ðŸŽ‰ Deploy
    runs-on: ubuntu-latest
    steps:
    - name: ðŸšš Get latest code
      uses: actions/checkout@v3
    # - name: ðŸ“‚ Sync files
    #   uses: SamKirkland/FTP-Deploy-Action@v4.3.4
    #   with:
    #     server: www.desagetasan.id
    #     username: ${{ secrets.ftp_username }}
    #     password: ${{ secrets.ftp_password }}
    #     server-dir: /public_html/cms/
    #     exclude: |
    #       **/.git*
    #       **/.git*/**
    #       **/vendor/**
    #       .env
    - name: SSH into CPanel
        uses: appleboy/ssh-action@master
        with:
          host: desagetasan.id
          username: ${{ secrets.ftp_username }}
          password: ${{ secrets.ftp_password }}
          port: 2222

          script: |
            cd public_html
            php composer-setup.php --install-dir=/home/user/bin --filename=composer
            php -r "unlink('composer-setup.php');"