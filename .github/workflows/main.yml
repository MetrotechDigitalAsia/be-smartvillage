on:
  push:
    branches:
      - rahmat
name: ðŸš€ Deploy website on push
jobs:
  web-deploy:
    name: ðŸŽ‰ Deploy
    runs-on: ubuntu-latest
    steps:
    - name: ðŸšš Get latest code
      uses: actions/checkout@v3
    - name: SSH into CPanel
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.CPANEL_HOST }}
          username: ${{ secrets.CPANEL_USERNAME }}
          password: ${{ secrets.CPANEL_PASSWORD }}
          port: ${{ secrets.CPANEL_SSH_PORT }}

          script: |
            cd public_html
            php composer-setup.php --install-dir=/home/user/bin --filename=composer
            php -r "unlink('composer-setup.php');"
    # - name: Install Composer Dependencies
    #   run: composer install --no-dev --no-progress --no-suggest
    #   working-directory: /public_html/cms